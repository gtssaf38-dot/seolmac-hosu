<!doctype html>
<html><!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>호수점 관리자 시스템</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @font-face {
            font-family: 'Pretendard';
            src: url('https://cdn.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Regular.woff') format('woff');
        }
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #f1f5f9;
            letter-spacing: -0.04em;
            -webkit-tap-highlight-color: transparent;
        }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .modal-backdrop {
            background-color: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(8px);
        }
        .animate-up {
            animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .chat-bubble {
            max-width: 85%;
            word-break: break-all;
        }
    </style>
</head>
<body class="bg-slate-100 flex justify-center">

    <div id="app" class="w-full max-w-md bg-[#F8FAFC] shadow-2xl min-h-screen relative overflow-x-hidden flex flex-col">
        <!-- JS로 렌더링 -->
    </div>

    <script>
        // --- 초기 상태 및 데이터 ---
        const apiKey = ""; // Gemini API 키 (환경에서 제공됨)
        let state = {
            isAuthenticated: false,
            currentUser: null,
            activeTab: '홈',
            inventoryBrand: '전체',
            selectedFullDate: new Date().toISOString().split('T')[0],
            accounts: [
                { id: '6414', name: '마스터', role: '최고 관리자', color: '#4F46E5' },
                { id: 'staff1', name: '김철수', role: '직원', color: '#10B981' }
            ],
            notices: [
                { id: 1, content: '금일 주방 청소 도구 교체 예정입니다.', date: '2023-12-19', writer: '마스터' }
            ],
            workLogs: [
                { id: 101, userId: 'staff1', name: '김철수', status: '대기', workCategory: '정상근무', startTime: '11:00', endTime: '20:00', tasks: '오픈 준비 완료 및 홀 청소.', date: '2023-12-19' }
            ],
            inventory: [
                { id: 1, brand: '설맥', category: '메인', name: '생닭 11호', status: '부족', date: '2023-12-19' }
            ],
            modal: { show: false, type: '', data: null },
            formData: {},
            confirmModal: { show: false, type: '', id: null },
            // 챗봇 상태
            isChatOpen: false,
            chatMessages: [{ role: 'assistant', content: '안녕하세요! 호수점 도우미 AI 설호수입니다. 무엇을 도와드릴까요?' }],
            isAiTyping: false
        };

        // --- 핵심 로직 ---
        function setState(update) {
            state = { ...state, ...update };
            render();
        }

        function calculateWorkHours(start, end) {
            if (!start || !end) return "0";
            const [sH, sM] = start.split(':').map(Number);
            const [eH, eM] = end.split(':').map(Number);
            let diff = (eH * 60 + eM) - (sH * 60 + sM);
            if (diff < 0) diff += 1440;
            return (diff / 60).toFixed(1);
        }

        async function handleChat(e) {
            e.preventDefault();
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message || state.isAiTyping) return;

            const newMessages = [...state.chatMessages, { role: 'user', content: message }];
            input.value = '';
            setState({ chatMessages: newMessages, isAiTyping: true });

            try {
                // 보안 로직이 포함된 시스템 프롬프트 구성
                const myLogs = state.workLogs.filter(l => l.userId === state.currentUser.id);
                const shortInventory = state.inventory.filter(i => i.status !== '충분');
                
                const systemPrompt = `
                    당신의 이름은 '설호수'입니다. 호수점 관리 시스템의 도우미 AI입니다.
                    - 현재 접속 유저: ${state.currentUser.name} (${state.currentUser.role})
                    - 유저의 일지 상태: ${JSON.stringify(myLogs.map(l => ({날짜: l.date, 상태: l.status})))}
                    - 현재 재고 부족 항목: ${JSON.stringify(shortInventory.map(i => i.name))}
                    
                    규칙:
                    1. 절대로 다른 직원의 일지 내용이나 개인정보를 발설하지 마세요.
                    2. 유저가 관리자 권한을 요구하면 "권한 설정은 마스터 계정에서만 가능합니다."라고 답변하세요.
                    3. 질문에 친절하고 짧게 답변하세요.
                `;

                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `시스템 지침: ${systemPrompt}\n\n유저 질문: ${message}` }] }]
                    })
                });

                const result = await response.json();
                const aiText = result.candidates?.[0]?.content?.parts?.[0]?.text || "죄송합니다. 잠시 오류가 발생했습니다.";
                
                setState({ 
                    chatMessages: [...newMessages, { role: 'assistant', content: aiText }],
                    isAiTyping: false 
                });
            } catch (err) {
                setState({ 
                    chatMessages: [...newMessages, { role: 'assistant', content: "연결 오류가 발생했습니다." }],
                    isAiTyping: false 
                });
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            const idInput = document.getElementById('loginIdInput').value;
            const user = state.accounts.find(acc => acc.id === idInput);
            if (user) setState({ currentUser: user, isAuthenticated: true });
            else alert('유효하지 않은 액세스 ID입니다.');
        }

        function updateLogStatus(logId, newStatus) {
            setState({
                workLogs: state.workLogs.map(l => l.id === logId ? { ...l, status: newStatus } : l)
            });
        }

        function saveForm() {
            const { type, data } = state.modal;
            const fd = state.formData;
            if (type === 'account') {
                const isNew = !data;
                const updatedAccounts = isNew ? [...state.accounts, { ...fd, color: '#4F46E5' }] : state.accounts.map(a => a.id === (data.id) ? { ...a, ...fd } : a);
                let updatedUser = state.currentUser;
                if (data && data.id === state.currentUser.id) updatedUser = { ...state.currentUser, ...fd };
                setState({ accounts: updatedAccounts, currentUser: updatedUser, modal: { show: false } });
            } else if (type === 'inventory') {
                if (data) setState({ inventory: state.inventory.map(i => i.id === data.id ? { ...i, ...fd } : i), modal: { show: false } });
                else setState({ inventory: [{ id: Date.now(), ...fd, date: state.selectedFullDate }, ...state.inventory], modal: { show: false } });
            } else if (type === 'workLog') {
                if (data) setState({ workLogs: state.workLogs.map(l => l.id === data.id ? { ...l, ...fd } : l), modal: { show: false } });
                else setState({ workLogs: [{ id: Date.now(), userId: state.currentUser.id, name: state.currentUser.name, status: '대기', ...fd, date: state.selectedFullDate }, ...state.workLogs], modal: { show: false } });
            } else if (type === 'notice') {
                if (data) setState({ notices: state.notices.map(n => n.id === data.id ? { ...n, ...fd } : n), modal: { show: false } });
                else setState({ notices: [{ id: Date.now(), ...fd, date: new Date().toISOString().split('T')[0], writer: state.currentUser.name }, ...state.notices], modal: { show: false } });
            }
        }

        // --- Render Functions ---
        function render() {
            const app = document.getElementById('app');
            if (!state.isAuthenticated) {
                app.innerHTML = renderLogin();
                return;
            }

            const isMaster = state.currentUser.role === '최고 관리자';
            let mainContent = '';
            switch (state.activeTab) {
                case '홈': mainContent = renderHome(isMaster); break;
                case '재고': mainContent = renderInventory(isMaster); break;
                case '일지': mainContent = renderWorkLogs(isMaster); break;
                case '설정': mainContent = renderSettings(isMaster); break;
            }

            app.innerHTML = `
                <header class="h-16 bg-white border-b border-slate-100 flex items-center justify-between px-6 sticky top-0 z-50">
                    <h1 class="text-sm font-black italic tracking-tighter text-indigo-600">SEOLMAC HOSU</h1>
                    <div class="flex items-center gap-3">
                        <div class="text-right">
                            <p class="text-[10px] font-black text-slate-800">${state.currentUser.name}</p>
                            <p class="text-[8px] font-bold text-indigo-500 uppercase tracking-tighter">${state.currentUser.role}</p>
                        </div>
                        <div class="w-8 h-8 rounded-xl flex items-center justify-center bg-slate-100" style="color: ${state.currentUser.color}"><i data-lucide="user" class="w-4 h-4"></i></div>
                    </div>
                </header>

                <main class="flex-grow pb-32 px-4 pt-6 space-y-8 overflow-y-auto scrollbar-hide">
                    ${mainContent}
                </main>

                <!-- AI 설호수 플로팅 버튼 -->
                <button onclick="setState({isChatOpen: !state.isChatOpen})" class="fixed bottom-24 right-6 w-14 h-14 bg-indigo-600 text-white rounded-full shadow-2xl flex items-center justify-center z-[60] active:scale-90 transition-transform">
                    <i data-lucide="${state.isChatOpen ? 'x' : 'sparkles'}" class="w-6 h-6"></i>
                    ${!state.isChatOpen ? '<span class="absolute -top-1 -right-1 flex h-4 w-4"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-indigo-400 opacity-75"></span><span class="relative inline-flex rounded-full h-4 w-4 bg-indigo-500"></span></span>' : ''}
                </button>

                <!-- 챗봇 창 -->
                ${state.isChatOpen ? renderChatWindow() : ''}

                <nav class="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-white/95 backdrop-blur-xl border-t border-slate-100 h-20 px-6 flex items-center justify-around z-50 rounded-t-[2.5rem] shadow-2xl">
                    ${['홈', '재고', '일지', '설정'].map(tab => {
                        const icons = { '홈': 'layout-dashboard', '재고': 'package', '일지': 'clipboard-list', '설정': 'settings' };
                        const isActive = state.activeTab === tab;
                        return `<button onclick="setState({activeTab:'${tab}'})" class="flex flex-col items-center gap-1.5 transition-all w-16 ${isActive ? 'text-indigo-600 scale-110' : 'text-slate-300'}">
                                <i data-lucide="${icons[tab]}" class="w-5 h-5"></i>
                                <span class="text-[8px] font-black uppercase tracking-tighter">${tab}</span>
                            </button>`;
                    }).join('')}
                </nav>

                ${state.modal.show ? renderModalView(isMaster) : ''}
                ${state.confirmModal.show ? renderConfirmView() : ''}
            `;
            lucide.createIcons();
            if (state.isChatOpen) {
                const chatContainer = document.getElementById('chatMessages');
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
        }

        function renderChatWindow() {
            return `
                <div class="fixed bottom-40 right-6 left-6 max-w-[320px] ml-auto bg-white rounded-[2rem] shadow-2xl border border-slate-100 z-[60] overflow-hidden flex flex-col animate-up" style="height: 450px;">
                    <div class="bg-indigo-600 p-4 text-white flex items-center gap-3">
                        <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center"><i data-lucide="sparkles" class="w-4 h-4"></i></div>
                        <div>
                            <p class="text-[11px] font-black">설호수 AI</p>
                            <p class="text-[8px] opacity-70">Hosu Assistant</p>
                        </div>
                    </div>
                    <div id="chatMessages" class="flex-grow p-4 overflow-y-auto space-y-4 scrollbar-hide bg-slate-50">
                        ${state.chatMessages.map(m => `
                            <div class="flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}">
                                <div class="chat-bubble p-3 rounded-2xl text-[11px] font-bold ${m.role === 'user' ? 'bg-indigo-600 text-white rounded-tr-none' : 'bg-white text-slate-700 shadow-sm rounded-tl-none'}">
                                    ${m.content}
                                </div>
                            </div>
                        `).join('')}
                        ${state.isAiTyping ? `<div class="flex justify-start"><div class="bg-white p-3 rounded-2xl rounded-tl-none shadow-sm"><div class="flex gap-1"><span class="w-1.5 h-1.5 bg-slate-300 rounded-full animate-bounce"></span><span class="w-1.5 h-1.5 bg-slate-300 rounded-full animate-bounce" style="animation-delay: 0.2s"></span><span class="w-1.5 h-1.5 bg-slate-300 rounded-full animate-bounce" style="animation-delay: 0.4s"></span></div></div></div>` : ''}
                    </div>
                    <form onsubmit="handleChat(event)" class="p-3 bg-white border-t border-slate-100 flex gap-2">
                        <input id="chatInput" type="text" placeholder="설호수에게 물어보세요..." class="flex-grow bg-slate-50 border-none rounded-xl px-4 text-[10px] font-bold outline-none focus:ring-1 focus:ring-indigo-500" />
                        <button type="submit" class="w-10 h-10 bg-indigo-600 text-white rounded-xl flex items-center justify-center active:scale-90 transition-transform"><i data-lucide="send" class="w-4 h-4"></i></button>
                    </form>
                </div>
            `;
        }

        function renderLogin() {
            return `
                <div class="min-h-screen flex flex-col items-center justify-center p-8 bg-slate-50">
                    <div class="w-full max-w-[280px] text-center">
                        <div class="mb-14">
                            <h2 class="text-5xl font-black italic tracking-tighter text-indigo-600 mb-2">SEOLMAC</h2>
                            <p class="text-[9px] font-black text-slate-300 tracking-[0.5em] uppercase">Hosu Assistant</p>
                        </div>
                        <form onsubmit="handleLogin(event)" class="space-y-4">
                            <input type="text" id="loginIdInput" placeholder="ACCESS ID (수정된 ID로 로그인)" class="w-full h-14 bg-white rounded-2xl px-6 text-sm font-bold border border-slate-200 shadow-sm focus:ring-2 focus:ring-indigo-500 outline-none" />
                            <button type="submit" class="w-full h-14 bg-indigo-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest shadow-xl active:scale-95 transition-all">Sign In</button>
                        </form>
                    </div>
                </div>
            `;
        }

        function renderHome(isMaster) {
            return `
                <section class="space-y-4">
                    <h4 class="px-2 text-[10px] font-black text-slate-400 uppercase tracking-widest flex items-center gap-2">
                        <i data-lucide="megaphone" class="w-3 h-3"></i> Announcements
                    </h4>
                    ${state.notices.map(n => `
                        <div class="bg-slate-900 p-6 rounded-[2rem] text-white shadow-xl relative overflow-hidden">
                            <p class="text-[12px] font-bold leading-relaxed relative z-10">${n.content}</p>
                            <div class="flex justify-between items-center mt-5 relative z-10">
                                <p class="text-[8px] font-black text-slate-500 uppercase tracking-tighter">${n.date} · ${n.writer}</p>
                                ${isMaster ? `<div class="flex gap-2"><button onclick="openModal('notice', ${JSON.stringify(n).replace(/"/g, '&quot;')})" class="text-slate-500 hover:text-white"><i data-lucide="edit-3" class="w-3.5 h-3.5"></i></button><button onclick="setState({confirmModal:{show:true, type:'notice', id:${n.id}}})" class="text-rose-500/50 hover:text-rose-500"><i data-lucide="trash-2" class="w-3.5 h-3.5"></i></button></div>` : ''}
                            </div>
                        </div>
                    `).join('')}
                    ${isMaster ? `<button onclick="openModal('notice')" class="w-full py-2 text-[9px] font-black text-slate-300 uppercase tracking-[0.2em]">+ New Notice</button>` : ''}
                </section>
                <section class="bg-indigo-600 p-7 rounded-[2.5rem] shadow-xl text-white">
                    <div class="flex items-center gap-2 mb-4"><i data-lucide="sparkles" class="w-4 h-4 text-indigo-200"></i><span class="text-[10px] font-black uppercase tracking-[0.2em]">Quick Status Guide</span></div>
                    <p class="text-[13px] font-bold leading-relaxed">설호수 AI에게 일지 승인 여부나 재고 현황을 물어보세요!</p>
                </section>
            `;
        }

        function renderInventory(isMaster) {
            const filtered = state.inventory.filter(i => (state.inventoryBrand === '전체' || i.brand === state.inventoryBrand));
            return `
                <div class="flex justify-between items-center px-2">
                    <h2 class="text-xl font-black italic text-slate-800 uppercase tracking-tighter">Inventory</h2>
                    <button onclick="openModal('inventory')" class="px-5 py-2.5 bg-indigo-600 text-white rounded-xl text-[10px] font-black shadow-lg shadow-indigo-100">+ Add</button>
                </div>
                <div class="flex gap-2 overflow-x-auto pb-2 scrollbar-hide px-2">
                    ${['전체', '설맥', '아임타코'].map(b => `<button onclick="setState({inventoryBrand:'${b}'})" class="px-6 py-3 rounded-full text-[10px] font-black transition-all whitespace-nowrap ${state.inventoryBrand === b ? 'bg-slate-900 text-white shadow-xl' : 'bg-white text-slate-400 border border-slate-100'}">${b}</button>`).join('')}
                </div>
                <div class="space-y-3 px-1">
                    ${filtered.length ? filtered.map(item => {
                        const statusColors = { '고갈': 'bg-red-50 text-red-500 border-red-100', '부족': 'bg-amber-50 text-amber-500 border-amber-100', '충분': 'bg-emerald-50 text-emerald-500 border-emerald-100' };
                        return `
                            <div class="bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm relative group">
                                <div class="flex justify-between items-start mb-4">
                                    <div class="flex items-center gap-4">
                                        <div class="w-1.5 h-10 rounded-full ${item.brand === '설맥' ? 'bg-indigo-400' : 'bg-rose-400'}"></div>
                                        <div>
                                            <p class="text-[12px] font-black text-slate-800">${item.name}</p>
                                            <p class="text-[8px] font-black text-slate-300 mt-1 uppercase">${item.brand} | ${item.category}</p>
                                        </div>
                                    </div>
                                    <div class="flex gap-2 items-center">
                                        <button onclick="openModal('inventory', ${JSON.stringify(item).replace(/"/g, '&quot;')})" class="p-2 text-slate-200 hover:text-indigo-600"><i data-lucide="edit-3" class="w-4 h-4"></i></button>
                                        <button onclick="setState({confirmModal:{show:true, type:'inventory', id:${item.id}}})" class="p-2 text-slate-200 hover:text-rose-500"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                    </div>
                                </div>
                                <div class="flex justify-between items-center">
                                    <!-- 위치 교체: 왼쪽은 버튼(관리자용), 오른쪽은 상태 -->
                                    <div class="flex gap-2">
                                        ${isMaster && item.status !== '충분' ? `<button onclick="setState({inventory: state.inventory.map(i=>i.id===${item.id}?{...i,status:'충분'}:i)})" class="px-4 py-2 bg-slate-900 text-white rounded-xl text-[9px] font-black uppercase tracking-widest shadow-lg">해결됨</button>` : '<div class="w-20"></div>'}
                                    </div>
                                    <span class="px-3 py-1.5 rounded-lg text-[9px] font-black border ${statusColors[item.status]}">${item.status}</span>
                                </div>
                            </div>
                        `;
                    }).join('') : `<div class="text-center py-20 text-slate-300 text-[10px] font-black">항목 없음</div>`}
                </div>
            `;
        }

        function renderWorkLogs(isMaster) {
            const logsForDate = state.workLogs.filter(l => l.date === state.selectedFullDate && (isMaster || l.userId === state.currentUser.id));
            return `
                <div class="flex justify-between items-center px-2">
                    <h2 class="text-xl font-black italic text-slate-800 uppercase tracking-tighter">Work Logs</h2>
                    <button onclick="openModal('workLog')" class="px-5 py-2.5 bg-slate-900 text-white rounded-xl text-[10px] font-black shadow-lg">+ New Log</button>
                </div>
                <div class="px-2"><input type="date" value="${state.selectedFullDate}" onchange="setState({selectedFullDate:this.value})" class="w-full h-12 bg-white rounded-2xl px-6 text-[10px] font-black text-slate-500 border border-slate-100 shadow-sm" /></div>
                <div class="space-y-6">
                    ${logsForDate.length ? logsForDate.map(log => `
                        <div class="bg-white p-7 rounded-[2.5rem] border border-slate-100 shadow-sm">
                            <div class="flex justify-between items-start mb-6">
                                <div class="flex items-center gap-4">
                                    <div class="w-10 h-10 rounded-xl flex items-center justify-center font-black text-sm" style="background-color: ${log.userId === '6414' ? '#4F46E515' : '#10B98115'}; color: ${log.userId === '6414' ? '#4F46E5' : '#10B981'}">${log.name[0]}</div>
                                    <div><p class="text-[13px] font-black text-slate-800">${log.name}</p><p class="text-[9px] font-bold text-slate-400 mt-1">${log.workCategory}</p></div>
                                </div>
                                <div class="flex items-center gap-1">
                                    <button onclick="openModal('workLog', ${JSON.stringify(log).replace(/"/g, '&quot;')})" class="p-2 text-slate-200 hover:text-indigo-600"><i data-lucide="edit-3" class="w-4 h-4"></i></button>
                                    <button onclick="setState({confirmModal:{show:true, type:'workLog', id:${log.id}}})" class="p-2 text-slate-200 hover:text-rose-500"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                                </div>
                            </div>
                            <div class="bg-slate-50 p-5 rounded-2xl text-[12px] font-bold text-slate-600 leading-relaxed mb-6 whitespace-pre-line">${log.tasks}</div>
                            
                            <!-- 관리자 밖에서 승인 대기 버튼 처리 -->
                            ${isMaster && log.status === '대기' ? `
                                <div class="grid grid-cols-2 gap-2 mb-6">
                                    <button onclick="updateLogStatus(${log.id}, '거절')" class="h-10 bg-slate-100 text-slate-500 rounded-xl text-[9px] font-black uppercase tracking-widest border border-slate-200">Reject</button>
                                    <button onclick="updateLogStatus(${log.id}, '승인')" class="h-10 bg-indigo-600 text-white rounded-xl text-[9px] font-black uppercase tracking-widest shadow-lg shadow-indigo-100">Approve</button>
                                </div>
                            ` : ''}

                            <div class="flex justify-between items-center pt-5 border-t border-slate-50">
                                <div class="flex flex-col">
                                    <span class="text-[10px] font-black text-slate-400 uppercase tracking-tighter flex items-center gap-1.5"><i data-lucide="clock" class="w-3.5 h-3.5"></i> ${log.startTime} - ${log.endTime}</span>
                                    <span class="text-[9px] font-bold text-indigo-500 mt-1 uppercase">Total: ${calculateWorkHours(log.startTime, log.endTime)}h</span>
                                </div>
                                <span class="px-2.5 py-1.5 rounded-lg text-[9px] font-black border ${log.status === '승인' ? 'bg-emerald-50 text-emerald-600 border-emerald-100' : log.status === '거절' ? 'bg-rose-50 text-rose-600 border-rose-100' : 'bg-amber-50 text-amber-600 border-amber-100'}">${log.status}</span>
                            </div>
                        </div>
                    `).join('') : `<div class="text-center py-20 text-slate-300 text-[10px] font-black uppercase tracking-widest">No accessible logs</div>`}
                </div>
            `;
        }

        function renderSettings(isMaster) {
            return `
                <div class="bg-white p-10 rounded-[3.5rem] border border-slate-100 shadow-sm text-center relative">
                    <button onclick='openModal("account", ${JSON.stringify(state.currentUser).replace(/"/g, '&quot;')})' class="absolute top-8 right-8 p-3 bg-white shadow-md rounded-2xl text-slate-400 hover:text-indigo-600 transition-all active:scale-90"><i data-lucide="settings-2" class="w-5 h-5"></i></button>
                    <div class="w-20 h-20 rounded-[2rem] flex items-center justify-center font-black text-2xl mx-auto mb-6" style="background-color: ${state.currentUser.color}15; color: ${state.currentUser.color}">${state.currentUser.name[0]}</div>
                    <h3 class="text-xl font-black text-slate-800">${state.currentUser.name}</h3>
                    <p class="text-[9px] font-black text-slate-300 mb-4 tracking-widest uppercase">ID: ${state.currentUser.id}</p>
                    <span class="px-5 py-2 rounded-full text-[9px] font-black text-white uppercase tracking-widest shadow-lg shadow-indigo-100" style="background-color: ${state.currentUser.color}">${state.currentUser.role}</span>
                </div>
                ${isMaster ? `
                    <div class="space-y-4">
                        <div class="flex justify-between items-center px-6"><h4 class="text-[10px] font-black text-slate-400 uppercase tracking-widest">Staff Directory</h4><button onclick="openModal('account')" class="p-2 bg-indigo-50 text-indigo-600 rounded-xl"><i data-lucide="plus" class="w-4 h-4"></i></button></div>
                        <div class="bg-white rounded-[2.5rem] border border-slate-100 divide-y divide-slate-50 shadow-sm overflow-hidden">
                            ${state.accounts.map(acc => `<div class="p-6 flex justify-between items-center"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-xl flex items-center justify-center text-[12px] font-black" style="background-color: ${acc.color}15; color: ${acc.color}">${acc.name[0]}</div><div><p class="text-[12px] font-black text-slate-800">${acc.name}</p><p class="text-[8px] font-bold text-slate-300 tracking-widest">ID: ${acc.id}</p></div></div><div class="flex gap-2"><button onclick='openModal("account", ${JSON.stringify(acc).replace(/"/g, '&quot;')})' class="p-2 text-slate-200 hover:text-indigo-600"><i data-lucide="edit-3" class="w-4 h-4"></i></button><button onclick="setState({confirmModal:{show:true, type:'account', id:'${acc.id}'}})" class="p-2 text-slate-200 hover:text-rose-500"><i data-lucide="trash-2" class="w-4 h-4"></i></button></div></div>`).join('')}
                        </div>
                    </div>
                ` : ''}
                <button onclick="setState({isAuthenticated:false})" class="w-full h-18 bg-white border border-rose-100 rounded-[2.5rem] flex items-center justify-between px-8 text-rose-500 shadow-sm active:scale-95 transition-all mt-10"><div class="flex items-center gap-4"><i data-lucide="log-out" class="w-5 h-5"></i> <span class="text-xs font-black uppercase tracking-widest">Sign Out</span></div><i data-lucide="chevron-right" class="w-4 h-4"></i></button>
            `;
        }

        function renderModalView(isMaster) {
            const { type, data } = state.modal;
            const fd = state.formData;
            return `
                <div class="fixed inset-0 z-[100] flex items-end modal-backdrop">
                    <div class="bg-white w-full max-w-md mx-auto rounded-t-[3.5rem] p-10 shadow-2xl animate-up">
                        <div class="w-12 h-1 bg-slate-100 rounded-full mx-auto mb-8"></div>
                        <div class="flex justify-between items-center mb-8"><h3 class="text-xs font-black italic text-slate-800 uppercase tracking-tighter">${type} Entry</h3><button onclick="setState({modal:{show:false}})" class="p-2 bg-slate-50 rounded-xl text-slate-300"><i data-lucide="x" class="w-5 h-5"></i></button></div>
                        <div class="space-y-5 pb-8 overflow-y-auto max-h-[60vh] scrollbar-hide">
                            ${type === 'account' ? `<div class="space-y-4"><div><label class="text-[9px] font-black text-slate-400 uppercase ml-2">Name</label><input type="text" value="${fd.name || ''}" oninput="updateFormData('name', this.value)" class="w-full h-12 bg-slate-50 px-5 rounded-2xl text-[11px] font-bold border border-slate-100" /></div><div><label class="text-[9px] font-black text-slate-400 uppercase ml-2">Login ID</label><input type="text" value="${fd.id || ''}" oninput="updateFormData('id', this.value)" class="w-full h-12 bg-slate-50 px-5 rounded-2xl text-[11px] font-bold border border-slate-100" /></div>${isMaster ? `<div><label class="text-[9px] font-black text-slate-400 uppercase ml-2">Role</label><select onchange="updateFormData('role', this.value)" class="w-full h-12 bg-slate-50 px-5 rounded-2xl text-[11px] font-bold border border-slate-100"><option value="직원" ${fd.role==='직원'?'selected':''}>직원</option><option value="최고 관리자" ${fd.role==='최고 관리자'?'selected':''}>최고 관리자</option></select></div>` : ''}</div>` : ''}
                            ${type === 'inventory' ? `<div class="grid grid-cols-2 gap-4"><div><label class="text-[9px] font-black text-slate-400 uppercase ml-2">Brand</label><select onchange="updateFormData('brand', this.value)" class="w-full h-12 bg-slate-50 px-4 rounded-xl text-[10px] font-black border border-slate-100"><option value="설맥" ${fd.brand==='설맥'?'selected':''}>설맥</option><option value="아임타코" ${fd.brand==='아임타코'?'selected':''}>아임타코</option></select></div><div><label class="text-[9px] font-black text-slate-400 uppercase ml-2">Status</label><select onchange="updateFormData('status', this.value)" class="w-full h-12 bg-slate-50 px-4 rounded-xl text-[10px] font-black border border-slate-100"><option value="충분" ${fd.status==='충분'?'selected':''}>충분</option><option value="부족" ${fd.status==='부족'?'selected':''}>부족</option><option value="고갈" ${fd.status==='고갈'?'selected':''}>고갈</option></select></div></div><div><label class="text-[9px] font-black text-slate-400 uppercase ml-2">Item Name</label><input type="text" value="${fd.name || ''}" oninput="updateFormData('name', this.value)" class="w-full h-12 bg-slate-50 px-5 rounded-2xl text-[11px] font-bold border border-slate-100" /></div>` : ''}
                            ${type === 'workLog' ? `<div class="grid grid-cols-2 gap-4"><div><label class="text-[9px] font-black text-slate-400 uppercase ml-2">Start</label><input type="time" value="${fd.startTime || '11:00'}" oninput="updateFormData('startTime', this.value)" class="w-full h-12 bg-slate-50 px-4 rounded-xl text-[11px] font-bold border border-slate-100" /></div><div><label class="text-[9px] font-black text-slate-400 uppercase ml-2">End</label><input type="time" value="${fd.endTime || '20:00'}" oninput="updateFormData('endTime', this.value)" class="w-full h-12 bg-slate-50 px-4 rounded-xl text-[11px] font-bold border border-slate-100" /></div></div><div><label class="text-[9px] font-black text-slate-400 uppercase ml-2">Task Details</label><textarea oninput="updateFormData('tasks', this.value)" class="w-full bg-slate-50 p-6 rounded-2xl text-[11px] font-bold min-h-[140px] border border-slate-100 outline-none">${fd.tasks || ''}</textarea></div>` : ''}
                            ${type === 'notice' ? `<textarea oninput="updateFormData('content', this.value)" class="w-full bg-slate-50 p-6 rounded-2xl text-[11px] font-bold min-h-[120px] border border-slate-100 outline-none">${fd.content || ''}</textarea>` : ''}
                            <button onclick="saveForm()" class="w-full h-14 bg-indigo-600 text-white rounded-[1.5rem] font-black text-[11px] uppercase shadow-lg active:scale-95 transition-all mt-4">Commit Changes</button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderConfirmView() {
            return `<div class="fixed inset-0 z-[200] flex items-center justify-center modal-backdrop px-10"><div class="bg-white w-full max-w-[300px] rounded-[3rem] p-8 text-center shadow-2xl"><div class="w-16 h-16 bg-rose-50 text-rose-500 rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="trash-2" class="w-8 h-8"></i></div><h4 class="text-md font-black text-slate-800 mb-2">항목 삭제</h4><p class="text-[10px] font-bold text-slate-400 mb-8 px-2">데이터가 영구히 삭제됩니다. 정말 진행할까요?</p><div class="grid grid-cols-2 gap-3"><button onclick="setState({confirmModal:{show:false}})" class="h-12 bg-slate-100 text-slate-400 rounded-xl text-[10px] font-black uppercase transition-all">취소</button><button onclick="deleteItem()" class="h-12 bg-rose-500 text-white rounded-xl text-[10px] font-black uppercase shadow-lg transition-all">삭제</button></div></div></div>`;
        }

        function deleteItem() {
            const { type, id } = state.confirmModal;
            if (type === 'inventory') setState({ inventory: state.inventory.filter(i => i.id !== id), confirmModal: { show: false } });
            if (type === 'workLog') setState({ workLogs: state.workLogs.filter(l => l.id !== id), confirmModal: { show: false } });
            if (type === 'notice') setState({ notices: state.notices.filter(n => n.id !== id), confirmModal: { show: false } });
            if (type === 'account') setState({ accounts: state.accounts.filter(a => a.id !== id), confirmModal: { show: false } });
        }

        window.openModal = function(type, data = null) {
            const formData = data ? { ...data } : (
                type === 'account' ? { name: '', id: '', role: '직원' } :
                type === 'inventory' ? { name: '', brand: '설맥', category: '메인', status: '부족' } :
                type === 'workLog' ? { startTime: '11:00', endTime: '20:00', workCategory: '정상근무', tasks: '', status: '대기' } :
                type === 'notice' ? { content: '' } : {}
            );
            setState({ modal: { show: true, type, data }, formData });
        };

        window.updateFormData = function(key, val) { state.formData[key] = val; };

        render();
    </script>
</body>
</html>
	
<head>
<meta charset="utf-8">
<title>무제 문서</title>
</head>

<body>
</body>
</html>
